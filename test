import pygame
import sys

pygame.init()

# Constants
WIDTH, HEIGHT = 1366, 768
WHITE = (255, 255, 255)
BLACK = (0, 0, 0)
GRID_SIZE = 50

# Initialize screen
screen = pygame.display.set_mode((WIDTH, HEIGHT))
pygame.display.set_caption("Mimic Language with Pygame")

# Font
font = pygame.font.Font(None, 36)

# Output list
outputs = []

def draw_circle():
    pygame.draw.circle(screen, BLACK, (WIDTH // 2, HEIGHT // 2), 50)

def draw_square(position):
    x, y = position
    pygame.draw.rect(screen, BLACK, (x, y, GRID_SIZE, GRID_SIZE))

def draw_grid():
    for x in range(0, WIDTH, GRID_SIZE):
        pygame.draw.line(screen, BLACK, (x, 0), (x, HEIGHT))
    for y in range(0, HEIGHT, GRID_SIZE):
        pygame.draw.line(screen, BLACK, (0, y), (WIDTH, y))

def get_position_from_input(input_text):
    if len(input_text) == 2 and input_text[0].isalpha() and input_text[1].isdigit():
        col = ord(input_text[0].lower()) - ord('a')
        row = int(input_text[1]) - 1
        return (col * GRID_SIZE, row * GRID_SIZE)
    return None

def main():
    global outputs
    input_text = ""
    clock = pygame.time.Clock()

    while True:
        for event in pygame.event.get():
            if event.type == pygame.QUIT:
                pygame.quit()
                sys.exit()
            elif event.type == pygame.KEYDOWN:
                if event.key == pygame.K_RETURN:
                    if input_text.startswith("sigma(") and input_text.endswith(")"):
                        output = input_text[6:-1]
                        outputs.append(output)
                    elif input_text.startswith("line"):
                        outputs.append("Drawing a line...")
                    elif input_text.startswith("circle"):
                        outputs.append("Drawing a circle...")
                    elif input_text.startswith("square"):
                        position = get_position_from_input(input_text[7:])
                        if position:
                            outputs.append(f"Drawing a square at {input_text[7:]}")
                            draw_square(position)
                    input_text = ""
                elif event.key == pygame.K_BACKSPACE:
                    input_text = input_text[:-1]
                else:
                    input_text += event.unicode

        screen.fill(WHITE)
        draw_grid()

        # Draw outputs
        y_offset = 0
        for output in outputs:
            text_surface = font.render(output, True, BLACK)
            screen.blit(text_surface, (10, 10 + y_offset))
            y_offset += 30

        # Draw shapes
        if "Drawing a line..." in outputs:
            pygame.draw.line(screen, BLACK, (10, HEIGHT // 2), (WIDTH - 10, HEIGHT // 2), 2)
        if "Drawing a circle..." in outputs:
            draw_circle()

        pygame.display.flip()
        clock.tick(30)

if __name__ == "__main__":
    main()
